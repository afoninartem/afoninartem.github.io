import{Z as R,D as U,r as k,a as _,aq as C,s as V,m as $,p as S,y as x,u as g,v as s,t as T,A,af as F,E as L,Q as I}from"./index.ba691094.js";import{Q as N}from"./QInput.245f7e6f.js";import{Q as P}from"./QTable.1d7c0313.js";import{A as X}from"./ArtisLoader.af894ec5.js";import"./private.use-form.4daa300e.js";import"./use-dark.f7e749a8.js";import"./use-file-dom-props.ced5b6e2.js";import"./use-key-composition.852cbf90.js";import"./QSeparator.01c15a6f.js";import"./QList.9741fd8f.js";import"./scroll.bdd282ec.js";import"./QChip.ae418503.js";import"./QItem.a685a859.js";import"./QMenu.d7488ea9.js";import"./position-engine.3cd88ab4.js";import"./selection.b8f65211.js";import"./QDialog.377e2582.js";import"./use-prevent-scroll.c672066b.js";import"./format.de7e9769.js";import"./QLinearProgress.25e65f71.js";import"./QSpinnerCube.47c3fa64.js";const E=R("stock",()=>{const{user:u}=U(),i=k(null),l=k([]),n=k({}),c=["shop_name","poster","vip","vip_pack","cup","cup_pack","vine","choco_set","chest","choco_5","candy","leaflet","green_baloon","gray_baloon","clamp","stick"],m={shop_name:"\u0421\u0430\u043B\u043E\u043D\u044B",poster:"\u041F\u043B\u0430\u043A\u0430\u0442",vip:"\u0412\u0418\u041F",vip_pack:"\u041F\u0430\u043A\u0435\u0442",cup:"\u041A\u0440\u0443\u0436\u043A\u0430",cup_pack:"\u0423\u043F\u0430\u043A",vine:"\u0412\u0438\u043D\u043E",choco_set:"\u041D\u0430\u0431\u043E\u0440",chest:"\u0420\u0430\u0437\u0432\u0435\u0440\u0442\u043A\u0430",choco_5:"5\u0433\u0440",candy:"\u041A\u0430\u0440\u0430\u043C\u0435\u043B\u044C",leaflet:"\u041B\u0438\u0441\u0442\u043E\u0432\u043A\u0430",green_baloon:"\u0417\u0435\u043B\u0435\u043D\u044B\u0439",gray_baloon:"\u0421\u0435\u0440\u044B\u0439",clamp:"\u0417\u0430\u0436\u0438\u043C",stick:"\u041F\u0430\u043B\u043A\u0430"},v=["paper","gift_adult","gift_male","gift_female","gift_child"],p={paper:"\u0413\u0430\u0437\u0435\u0442\u044B",gift_adult:"\u0412\u0437\u0440",gift_male:"\u041C\u0443\u0436",gift_female:"\u0416\u0435\u043D",gift_child:"\u0414\u0435\u0442"},b=async()=>{await C.get("warehouse/stock",{headers:{Authorization:`Bearer ${u.token}`}}).then(e=>{console.log(e),i.value=e.data.data,l.value=c,n.value=m}).catch(e=>console.log(e))},y=async e=>{const r=new FormData;r.append("extra",e),await C.post("warehouse/stock/upload",r,{headers:{Authorization:`Bearer ${u.token}`,"Content-Type":"multipart/form-data"}}).then(t=>{t.data.status?(i.value=t.data.data,l.value=c.concat(v),n.value=Object.assign({},m,p)):(console.log(t),alert(t.data.error))}).catch(t=>console.log(t))},w=()=>{var e=[];return l.value.forEach(r=>{e.push(n.value[r])}),console.log(e),e},o=async()=>{const e=new URLSearchParams;e.append("titles",w());const r=`warehouse/stock/download?${e.toString()}`;await C.get(r,{headers:{Authorization:`Bearer ${u.token}`},responseType:"blob"}).then(t=>{const Q=t.headers.get("Content-Type");console.log(Q);const q="\u0410\u043A\u0446\u0438\u043E\u043D\u043D\u0430\u044F \u0442\u0430\u0431\u043B\u0438\u0446\u0430.xlsx",B=URL.createObjectURL(t.data),d=document.createElement("a");d.href=B,d.download=q,document.body.appendChild(d),d.click(),document.body.removeChild(d),window.URL.revokeObjectURL(B)}).catch(t=>console.log(t))},a=_(()=>i.value),f=_(()=>l.value),h=_(()=>n.value);return{getStockShipment:b,saveXLSX:o,addExtra:y,stock:a,titles:f,labels:h}}),j={class:"stock"},z={key:0,class:"table"},O={key:1,class:"loader"},ue={__name:"StockPage",setup(u){const{getStockShipment:i,addExtra:l,saveXLSX:n}=E(),{stock:c,titles:m,labels:v}=V(E()),p=k(""),b=_(()=>m.value.map(o=>({name:o,required:!0,label:v.value[o]||o,field:o,align:"center",sortable:!0}))),y=o=>{const a=o.target.files[0];a&&l(a)},w={page:1,rowsPerPage:0};return $(()=>{i()}),(o,a)=>(S(),x("div",j,[g(c)?(S(),x("div",z,[s(P,{title:"\u041E\u0442\u0433\u0440\u0443\u0437\u043A\u0430 \u043A \u0430\u043A\u0446\u0438\u0438",rows:g(c),columns:b.value,pagination:w,filter:p.value,separator:"cell",bordered:"",dense:""},{"top-right":T(f=>[s(L,{icon:"add",class:"q-ml-sm",label:"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C",color:"primary",onClick:a[0]||(a[0]=h=>o.$refs.fileInput.click())}),s(L,{icon:"download",class:"q-ml-sm",label:"\u0421\u043A\u0430\u0447\u0430\u0442\u044C",color:"primary",onClick:g(n)},null,8,["onClick"]),s(N,{dense:"",debounce:"300",modelValue:p.value,"onUpdate:modelValue":a[1]||(a[1]=h=>p.value=h),name:"search",placeholder:"\u041F\u043E\u0438\u0441\u043A",class:"q-ml-sm"},{append:T(()=>[s(I,{name:"search"})]),_:1},8,["modelValue"]),s(L,{flat:"",round:"",dense:"",icon:f.inFullscreen?"fullscreen_exit":"fullscreen",onClick:f.toggleFullscreen,class:"q-ml-md"},null,8,["icon","onClick"])]),_:1},8,["rows","columns","filter"])])):A("",!0),g(c)?A("",!0):(S(),x("div",O,[s(X)])),F("input",{ref:"fileInput",type:"file",style:{display:"none"},onChange:y},null,544)]))}};export{ue as default};
