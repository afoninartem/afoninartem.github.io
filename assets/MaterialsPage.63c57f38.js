import{b as I,Q as O}from"./QTable.1d7c0313.js";import{Z as K,D as L,r as c,a as _,aq as P,s as $,m as W,p as V,y as D,v as l,t as r,Q as B,E as M,q as T,A as S,u as k,o as H,R as Z,x as G,af as h,B as A,aF as j,aT as J}from"./index.ba691094.js";import{Q as b}from"./QInput.245f7e6f.js";import{Q as X}from"./QTd.f544bb71.js";import{Q as Y,a as ee}from"./QBar.4a2b900e.js";import{Q as le}from"./QTooltip.cacf770e.js";import{Q as ae,a as z}from"./QCard.7c7b56c9.js";import{Q as R}from"./QToggle.d97530b3.js";import{Q as te}from"./QForm.5f7b4f42.js";import{Q as oe}from"./QDialog.377e2582.js";import{u as se}from"./use-quasar.73d2baa2.js";import"./QSeparator.01c15a6f.js";import"./use-dark.f7e749a8.js";import"./QList.9741fd8f.js";import"./scroll.bdd282ec.js";import"./private.use-form.4daa300e.js";import"./QChip.ae418503.js";import"./QItem.a685a859.js";import"./QMenu.d7488ea9.js";import"./position-engine.3cd88ab4.js";import"./selection.b8f65211.js";import"./use-key-composition.852cbf90.js";import"./format.de7e9769.js";import"./QLinearProgress.25e65f71.js";import"./use-file-dom-props.ced5b6e2.js";import"./use-prevent-scroll.c672066b.js";const U=K("materials",()=>{const{user:g}=L(),p=c([]),d=c(!1),u=c(null),i=c(null),v=(o,x)=>{u.value=x,d.value=!0,i.value={...u.value}},w=()=>{u.value={...i.value}},C=async()=>{await P.post("/warehouse/materials/update",{...u.value},{headers:{Authorization:`Bearer ${g.token}`}}).then(o=>{e()}).catch(o=>console.log(o))},f=async()=>{await P.post("/warehouse/materials/delete",{...u.value},{headers:{Authorization:`Bearer ${g.token}`}}).then(o=>{e(),console.log(o.data.data)}).catch(o=>console.log(o))},y=()=>{d.value=!1,u.value=null},e=async()=>{await P.get("/warehouse/materials",{headers:{Authorization:`Bearer ${g.token}`}}).then(o=>p.value=o.data.data).catch(o=>console.log(o))},Q=_(()=>p.value),n=_(()=>d.value),s=_(()=>u.value),m=_(()=>i.value);return{materials:Q,dialogState:n,initiateCard:m,materialCard:s,deleteMaterial:f,getAllMaterials:e,openMaterialCard:v,resetMaterialCard:w,saveMaterialCard:C,closeMaterialCard:y}}),ne={class:"container"},re={__name:"MaterialsTable",setup(g){const{materials:p,dialogState:d}=$(U()),{getAllMaterials:u,openMaterialCard:i}=U(),v=c([]),w=_(()=>v.value.length==0?p.value:p.value.filter(n=>v.value.some(s=>n.code.includes(s)))),C=[{label:"\u0420\u0435\u043C\u043E\u043D\u0442/\u041F\u0430\u043D\u0435\u043B\u0438",value:"PANEL"},{label:"\u0420\u0435\u043C\u043E\u043D\u0442/\u0424\u043E\u0442\u043E\u043E\u0431\u043E\u0438",value:"WPPHO"},{label:"\u0420\u0435\u043C\u043E\u043D\u0442/\u041E\u0431\u043E\u0438",value:"WPCOM"},{label:"\u0420\u0435\u043C\u043E\u043D\u0442/\u0414\u0438\u0437. \u043E\u0431\u043E\u0438",value:"WPDES"},{label:"\u0420\u0435\u043C\u043E\u043D\u0442/\u041E\u0441\u0432\u0435\u0449\u0435\u043D\u0438\u0435",value:"LIGHT"},{label:"\u0424\u0421: \u043F\u0438\u0449\u0435\u0432\u0430\u044F",value:"TREAT"},{label:"\u0421\u0442\u043E\u043B\u043E\u0432\u0430\u044F",value:"DINER"},{label:"\u0414\u0435\u043A\u043E\u0440",value:"DECOR"}],f=c(""),y=[["code","\u041A\u043E\u0434\u0412\u044B\u0433\u0440\u0443\u0437\u043A\u0438"],["name","\u041D\u0430\u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u0435"],["min_leftover","\u041C\u0438\u043D. \u043E\u0441\u0442\u0430\u0442\u043E\u043A"],["pack","\u0423\u043F\u0430\u043A\u043E\u0432\u043A\u0430"],["is_stopped","\u041E\u0442\u0433\u0440\u0443\u0436\u0430\u0435\u043C?"],["has_limits","\u041E\u0433\u0440\u0430\u043D\u0438\u0447\u0435\u043D\u0438\u044F"],["cabinet","\u0425\u0440\u0430\u043D\u0435\u043D\u0438\u0435"]],e=_(()=>y.map(n=>({name:n[0],required:!0,label:n[1],field:n[0],format:s=>n[0]=="has_limits"?s?"\u0414\u0430":"\u041D\u0435\u0442":n[0]=="cabinet"?s?"\u041A\u0430\u0431\u0438\u043D\u0435\u0442":"\u0421\u043A\u043B\u0430\u0434":`${s}`,align:"left",sortable:!0}))),Q={page:1,rowsPerPage:0};return W(async()=>{await u()}),(n,s)=>(V(),D("div",ne,[l(O,{title:"\u0420\u041F \u0438 \u0410\u0425\u041E",rows:w.value,columns:e.value,class:"my-sticky-header-table","row-key":"code",onRowClick:k(i),pagination:Q,filter:f.value},{"top-right":r(m=>[l(I,{modelValue:v.value,"onUpdate:modelValue":s[0]||(s[0]=o=>v.value=o),multiple:"",outlined:"",dense:"","options-dense":"","emit-value":"","map-options":"",label:"\u041F\u0430\u043F\u043A\u0438",options:C,style:{"min-width":"150px"},class:"q-mr-md"},null,8,["modelValue"]),l(b,{dense:"",debounce:"300",modelValue:f.value,"onUpdate:modelValue":s[1]||(s[1]=o=>f.value=o),name:"search",placeholder:"\u041F\u043E\u0438\u0441\u043A"},{append:r(()=>[l(B,{name:"search"})]),_:1},8,["modelValue"]),l(M,{flat:"",round:"",dense:"",icon:m.inFullscreen?"fullscreen_exit":"fullscreen",onClick:m.toggleFullscreen,class:"q-ml-md"},null,8,["icon","onClick"])]),"body-cell-is_stopped":r(m=>[l(X,{props:m},{default:r(()=>[m.value=="true"?(V(),T(B,{key:0,name:"do_not_disturb",color:"negative",size:"24px"})):S("",!0),m.value=="false"?(V(),T(B,{key:1,name:"check_circle",color:"positive",size:"24px"})):S("",!0)]),_:2},1032,["props"])]),_:1},8,["rows","columns","onRowClick","filter"])]))}},ue={class:"text-h5"},ie={class:"text-h6"},de={class:"btn-block"},me={__name:"MaterialCard",setup(g){se();const{user:p}=$(L()),{dialogState:d,materialCard:u}=$(U()),{closeMaterialCard:i,resetMaterialCard:v,saveMaterialCard:w,deleteMaterial:C}=U(),f=c(!0),y=c(null),e=c(u),Q=c(null),n=()=>{y.value=setTimeout(()=>{m()},1e3)},s=()=>{clearTimeout(y.value)},m=()=>{C(),i()},o=_(()=>e.value.stop_date=="0001-01-01T00:00:00Z"||e.value.stop_date==null?"\u043D\u0430\u0447\u0430\u043B\u0430 \u0432\u0440\u0435\u043C\u0435\u043D":new Date(e.value.stop_date).toLocaleDateString("ru-RU")),x=()=>{e.value.stop_date=new Date},F=async()=>{w()},N=()=>{v()};H(()=>{document.addEventListener("keydown",E)}),Z(()=>{document.removeEventListener("keydown",E)});const E=q=>{q.key==="Escape"&&d.value&&i()};return(q,a)=>(V(),D("div",{class:"container",onKeydown:a[10]||(a[10]=J((...t)=>k(i)&&k(i)(...t),["esc"]))},[l(oe,{modelValue:k(d),"onUpdate:modelValue":a[9]||(a[9]=t=>j(d)?d.value=t:null),persistent:"",maximized:f.value,"transition-show":"slide-left","transition-hide":"slide-left"},{default:r(()=>[l(ae,null,{default:r(()=>[l(Y,null,{default:r(()=>[l(ee),l(M,{dense:"",flat:"",icon:"close",onClick:k(i)},{default:r(()=>[l(le,{class:"bg-white text-primary"},{default:r(()=>[G("\u0417\u0430\u043A\u0440\u044B\u0442\u044C")]),_:1})]),_:1},8,["onClick"])]),_:1}),l(z,null,{default:r(()=>[h("div",ue,A(e.value.name),1),h("div",ie,A(e.value.code),1)]),_:1}),l(z,{class:"q-pt-none"},{default:r(()=>[l(te,{ref_key:"materialCardForm",ref:Q,onSubmit:F,onReset:N,class:"q-gutter-md"},{default:r(()=>[l(b,{label:"\u0410\u0434\u0440\u0435\u0441\u0430",filled:"",outlined:"",modelValue:e.value.address,"onUpdate:modelValue":a[0]||(a[0]=t=>e.value.address=t)},null,8,["modelValue"]),l(b,{label:"\u041E\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0435\u043D\u043D\u044B\u0439 \u0437\u0430 \u0437\u0430\u043A\u0430\u0437 \u043C\u0430\u0442\u0435\u0440\u0438\u0430\u043B\u0430 (email)",filled:"",outlined:"",modelValue:e.value.responsible,"onUpdate:modelValue":a[1]||(a[1]=t=>e.value.responsible=t)},null,8,["modelValue"]),l(b,{type:"number",label:"\u041C\u0438\u043D\u0438\u043C\u0430\u043B\u044C\u043D\u044B\u0439 \u043E\u0441\u0442\u0430\u0442\u043E\u043A",modelValue:e.value.min_leftover,"onUpdate:modelValue":a[2]||(a[2]=t=>e.value.min_leftover=t)},null,8,["modelValue"]),l(b,{type:"number",label:"\u0421\u0442\u0430\u043D\u0434\u0430\u0440\u0442\u043D\u0430\u044F \u043F\u0430\u0440\u0442\u0438\u044F",modelValue:e.value.standart_delivery,"onUpdate:modelValue":a[3]||(a[3]=t=>e.value.standart_delivery=t)},null,8,["modelValue"]),l(b,{type:"number",label:"\u0423\u043F\u0430\u043A\u043E\u0432\u043A\u0430",modelValue:e.value.pack,"onUpdate:modelValue":a[4]||(a[4]=t=>e.value.pack=t)},null,8,["modelValue"]),l(R,{label:e.value.is_stopped?`\u0412 \u0441\u0442\u043E\u043F-\u043B\u0438\u0441\u0442\u0435 \u0441 ${o.value}`:`\u041E\u0442\u0433\u0440\u0443\u0436\u0430\u0435\u043C \u0441 ${o.value}`,color:"red","false-value":!1,"true-value":!0,modelValue:e.value.is_stopped,"onUpdate:modelValue":[a[5]||(a[5]=t=>e.value.is_stopped=t),x]},null,8,["label","modelValue"]),l(R,{label:e.value.has_limits?"\u0415\u0441\u0442\u044C \u043E\u0433\u0440\u0430\u043D\u0438\u0447\u0435\u043D\u0438\u044F":"\u041D\u0435\u0442 \u043E\u0433\u0440\u0430\u043D\u0438\u0447\u0435\u043D\u0438\u0439",color:"red","false-value":!1,"true-value":!0,modelValue:e.value.has_limits,"onUpdate:modelValue":a[6]||(a[6]=t=>e.value.has_limits=t)},null,8,["label","modelValue"]),l(R,{label:e.value.cabinet?"\u0425\u0440\u0430\u043D\u0438\u0442\u0441\u044F \u0432 \u043A\u0430\u0431\u0438\u043D\u0435\u0442\u0435":"\u0425\u0440\u0430\u043D\u0438\u0442\u0441\u044F \u043D\u0430 \u0441\u043A\u043B\u0430\u0434\u0435",color:"yellow","false-value":!1,"true-value":!0,modelValue:e.value.cabinet,"onUpdate:modelValue":a[7]||(a[7]=t=>e.value.cabinet=t)},null,8,["label","modelValue"]),e.value.has_limits?(V(),T(b,{key:0,type:"number",label:"\u041E\u0433\u0440\u0430\u043D\u0438\u0447\u0435\u043D\u0438\u0435 \u043D\u0430 \u043E\u0442\u0433\u0440\u0443\u0437\u043A\u0443 (\u0432 \u0435\u0434\u0438\u043D\u0438\u0446\u0430\u0445 \u0438\u0437\u043C\u0435\u0440\u0435\u043D\u0438\u044F \u043C\u0430\u0442\u0435\u0440\u0438\u0430\u043B\u0430)",modelValue:e.value.limit,"onUpdate:modelValue":a[8]||(a[8]=t=>e.value.limit=t)},null,8,["modelValue"])):S("",!0),h("div",de,[l(M,{label:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C",type:"submit",color:"positive"}),l(M,{label:"\u0421\u0431\u0440\u043E\u0441",type:"reset",color:"primary",flat:"",class:"q-ml-sm"}),k(p).role==1?(V(),T(M,{key:0,label:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C",color:"red",flat:"",class:"q-ml-sm",onMousedown:n,onMouseup:s,onMouseleave:s})):S("",!0)])]),_:1},512)]),_:1})]),_:1})]),_:1},8,["modelValue","maximized"])],32))}},ce={class:"container"},pe=h("h3",null,"\u0421\u043F\u0440\u0430\u0432\u043E\u0447\u043D\u0438\u043A \u043C\u0430\u0442\u0435\u0440\u0438\u0430\u043B\u043E\u0432",-1),Le={__name:"MaterialsPage",setup(g){return(p,d)=>(V(),D("div",ce,[pe,l(re),l(me)]))}};export{Le as default};
