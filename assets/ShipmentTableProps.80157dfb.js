import{Z as z,D as C,r as $,a as D,aq as I,p as s,y as n,af as e,B as l,F as g,z as k,aQ as P,x as S,A as _,_ as L,o as q,ag as F,u as p,q as M,aR as N,aS as V}from"./index.35d82f09.js";import{u as j}from"./leftDrawer-store.b2aeca94.js";const O=z("shipment",()=>{const{user:t}=C(),{closeLeftDrawer:c}=j(),h=$(null),m=D(()=>h.value),u=()=>{var i;return(i=h.value)!=null&&i.spbnn.exists?"spbnn":"msc"},o=[{label:"\u2116",field:"num"},{label:"\u041C\u0430\u0448\u0438\u043D\u0430",field:"transport"},{label:"\u0421\u0430\u043B\u043E\u043D",field:"shop"},{label:"\u041C\u0430\u0442\u0435\u0440\u0438\u0430\u043B\u044B",field:"materials"},{label:"\u041F/\u041F",field:"shipment_places"},{label:"\u0417\u0430\u044F\u0432\u043A\u0438",field:"orders"}],w=D(()=>o.map(i=>({name:i.field,required:!0,label:i.label,field:i.field,align:"left",sortable:!1}))),x=D(()=>h.value.table);return{shipment:m,columns:w,rows:x,show:async()=>{await I.get("/warehouse/shipment/show",{headers:{Authorization:`Bearer ${t.token}`}}).then(i=>{h.value=i.data.data,console.log(i.data.data)}).catch(i=>console.log(i))},print:async()=>{c(),setTimeout(()=>window.print(),1)},defaultRegion:u}});const Q={class:"shipment-total"},Z={key:0},G="\u0428\u043E\u043A\u043E\u043B\u0430\u0434 \u0441 \u043B\u043E\u0433\u043E\u0442\u0438\u043F\u043E\u043C 5 \u0433\u0440.",H={__name:"ShipmentTotal",props:["shipment","tubuses"],setup(t){const c=t,h=m=>m.includes("TREAT")||m.includes("PAPER")?"font-weight: 700":null;return(m,u)=>(s(),n("div",Q,[e("h6",null,"\u0412\u0441\u0435\u0433\u043E \u0432 \u0441\u0431\u043E\u0440\u043A\u0435 "+l(new Date().toLocaleDateString())+":",1),e("ol",null,[(s(!0),n(g,null,k(t.shipment.vtl,(o,w)=>(s(),n("li",{key:`tl-${w}`},[e("p",{style:P(h(o.code))},[S(l(o.name)+" - "+l(o.amount),1),o.name==G?(s(),n("span",Z," (\u0432 \u0442\u0443\u0431\u0430\u0445 - "+l(c.tubuses)+")",1)):_("",!0)],4)]))),128))])]))}};const f=t=>(N("data-v-3035d4f0"),t=t(),V(),t),J={key:0,class:"shipment"},K={class:"warning"},U=f(()=>e("p",null,"\u0414\u043B\u044F \u043A\u043E\u0440\u0440\u0435\u043A\u0442\u043D\u043E\u0439 \u043F\u0435\u0447\u0430\u0442\u0438 \u0442\u0430\u0431\u043B\u0438\u0446\u044B \u0441\u043B\u0435\u0434\u0443\u0435\u0442 \u0438\u0441\u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u044C \u0431\u0440\u0430\u0443\u0437\u0435\u0440 Mozilla Firefox. Chrome \u043B\u043E\u043C\u0430\u0435\u0442 \u043C\u0430\u0441\u0448\u0442\u0430\u0431.",-1)),W=f(()=>e("p",null,"\u041F\u0440\u0438 \u043F\u0435\u0447\u0430\u0442\u0438 \u041E\u0411\u042F\u0417\u0410\u0422\u0415\u041B\u042C\u041D\u041E \u0432\u044B\u0432\u043E\u0434\u0438\u0442\u044C \u043A\u043E\u043B\u043E\u043D\u0442\u0438\u0442\u0443\u043B\u044B \u0441 \u043D\u0443\u043C\u0435\u0440\u0430\u0446\u0438\u0435\u0439 \u0441\u0442\u0440\u0430\u043D\u0438\u0446!",-1)),X={key:0},Y={key:1},ee={class:"region-btns"},te=["onClick"],se={class:"print-area"},ne={class:"shipment__info"},le=f(()=>e("thead",null,[e("tr",null,[e("th",{class:"header rownum"},"\u2116"),e("th",{class:"header transport"},"\u041C\u0430\u0448\u0438\u043D\u0430"),e("th",{class:"header shop"},"\u0421\u0430\u043B\u043E\u043D"),e("th",{class:"header materials"},"\u041C\u0430\u0442\u0435\u0440\u0438\u0430\u043B\u044B"),e("th",{class:"header places"},"\u041F/\u041F"),e("th",{class:"header orders"},"\u0417\u0430\u044F\u0432\u043A\u0438")])],-1)),oe=f(()=>e("td",{class:"rownum"},null,-1)),ae={class:"transport"},ie={class:"shop"},re=f(()=>e("br",null,null,-1)),ce={key:0},ue=f(()=>e("hr",null,null,-1)),de={class:"materials"},he={key:0,style:{border:"3px double"}},me=f(()=>e("td",null,null,-1)),pe={class:"orders"},_e=f(()=>e("p",{style:{"text-align":"center"}},"\u041A\u041E\u041D\u0415\u0426 \u0422\u0410\u0411\u041B\u0418\u0426\u042B",-1)),fe={__name:"ShipmentTableProps",props:["shipment"],setup(t){const c=t,{defaultRegion:h}=O();let m=$(null);const u=$(null);let o=$(h());const w={msc:"\u041C\u043E\u0441\u043A\u0432\u0430 \u0438 \u041F\u0440\u043E\u0447\u0438\u0435 \u0440\u0435\u0433\u0438\u043E\u043D\u044B",spb:"\u0421\u0430\u043D\u043A\u0442-\u041F\u0435\u0442\u0435\u0440\u0431\u0443\u0440\u0433",nn:"\u041D\u0438\u0436\u043D\u0438\u0439 \u041D\u043E\u0432\u0433\u043E\u0440\u043E\u0434 \u0438 \u043F\u0440\u0438\u043B\u0435\u0436\u0430\u0449\u0438\u0435 \u0440\u0435\u0433\u0438\u043E\u043D\u044B",spbnn:"\u0421\u041F\u0411 + \u041D\u041D"},x=r=>{let b=0;return r.orders.forEach(a=>{a.comment.includes("\u0441\u043E\u0431\u0440\u0430\u043D")&&r.materials.forEach(d=>{d.name.includes("\u0441\u043E\u0431\u0440\u0430\u043D\u043E \u043C\u0435\u0441\u0442")&&(b+=+d.amount)})}),b},A=()=>{let r={};Object.keys(c.shipment).forEach(a=>{c.shipment[a]&&c.shipment[a].exists&&(r[a]=c.shipment[a])}),m.value=r},B=()=>{let r;const b=c.shipment.vtl.filter(a=>a.name=="\u0428\u043E\u043A\u043E\u043B\u0430\u0434 \u0441 \u043B\u043E\u0433\u043E\u0442\u0438\u043F\u043E\u043C 5 \u0433\u0440.");b.length>0&&(r=b[0].amount/250),u.value=r},i=r=>{o.value=r},R=r=>{if(r.includes("\u0441\u043E\u0431\u0440\u0430\u043D"))return"border: 1px double black"};return q(()=>{A(),B()}),(r,b)=>t.shipment?(s(),n("div",J,[e("div",K,[U,W,u.value>0?(s(),n("p",X,"\u0412\u0441\u0435 \u0442\u0443\u0431\u044B c \u0448\u043E\u043A\u043E\u043B\u0430\u0434\u043E\u043C \u043E\u0431\u044F\u0437\u0430\u0442\u0435\u043B\u044C\u043D\u043E \u0441\u0431\u043E\u043A\u0443 \u043F\u0440\u043E\u043C\u0430\u0440\u043A\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u0434\u0430\u0442\u043E\u0439! \u0414\u0430, \u0410\u043B\u0435\u043A\u0441\u0435\u0439, \u0434\u0430\u0436\u0435 \u0435\u0441\u043B\u0438 \u0430\u043A\u0446\u0438\u044F \u0438 \u0440\u0430\u0431\u043E\u0442\u044B \u043C\u043D\u043E\u0433\u043E.")):_("",!0),u.value>0?(s(),n("p",Y,[S("\u0421\u0435\u0433\u043E\u0434\u043D\u044F \u043F\u043E\u0442\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044F \u044D\u0442\u0438\u043A\u0435\u0442\u043E\u043A \u0441 \u0434\u0430\u0442\u043E\u0439: "),e("b",null,l(u.value),1),S(".")])):_("",!0)]),e("div",ee,[(s(!0),n(g,null,k(p(m),(a,d)=>(s(),n("div",{class:"region-btns__btn",key:`reg-btn-${a}`},[t.shipment[d].exists?(s(),n("button",{key:0,onClick:F(v=>i(d),["prevent"])},l(w[d]),9,te)):_("",!0)]))),128))]),e("div",se,[e("div",ne,[e("p",null,"\u041E\u0442\u0433\u0440\u0443\u0437\u043A\u0430 \u043D\u0430 "+l(t.shipment[p(o)].shipment_info.shipment_date),1),e("p",null,"\u0421\u0431\u043E\u0440\u043A\u0430 "+l(t.shipment[p(o)].shipment_info.gathering_date),1),e("p",null,"\u041D\u0430\u0447\u0430\u043B\u043E \u0440\u0430\u0431\u043E\u0442\u044B "+l(t.shipment[p(o)].shipment_info.start_time),1),e("p",null,"\u0420\u0435\u0433\u0438\u043E\u043D: "+l(t.shipment[p(o)].shipment_info.region),1),e("p",null,"\u0417\u0430\u044F\u0432\u043E\u043A: "+l(t.shipment[p(o)].shipment_info.orders_number),1),e("p",null,"\u0421\u0430\u043B\u043E\u043D\u043E\u0432: "+l(t.shipment[p(o)].shipment_info.shops_number),1)]),e("table",null,[le,(s(!0),n(g,null,k(t.shipment[p(o)].shipment_data.transport,(a,d)=>(s(),n("tbody",{class:"table-body",key:`t-${d}`},[(s(!0),n(g,null,k(a.shops,(v,E)=>(s(),n("tr",{key:`s-${E}`},[oe,e("td",ae,l(a.name),1),e("td",ie,[S(l(v.name),1),re,e("span",null,"[ "+l(v.floor)+" \u044D\u0442\u0430\u0436 ]",1),x(v)>0?(s(),n("span",ce,[ue,S("\u0421\u043E\u0431\u0440\u0430\u043D\u043E \u043C\u0435\u0441\u0442: "+l(x(v)),1)])):_("",!0)]),e("td",null,[e("div",de,[(s(!0),n(g,null,k(v.materials,(y,T)=>(s(),n("div",{class:"material",key:`m-${T}`},[e("p",null,[y.cabinet?(s(),n("span",he,"213")):_("",!0),S(" "+l(y.name)+" - ",1),e("strong",null,l(y.amount),1)])]))),128))])]),me,e("td",null,[e("div",pe,[(s(!0),n(g,null,k(v.orders,(y,T)=>(s(),n("p",{key:`${d}${E}${T}`,style:P(R(y.comment))},l(y.number),5))),128))])])]))),128))]))),128))]),_e,t.shipment&&t.shipment.vtl?(s(),M(H,{key:0,shipment:t.shipment,tubuses:u.value},null,8,["shipment","tubuses"])):_("",!0)])])):_("",!0)}};var ye=L(fe,[["__scopeId","data-v-3035d4f0"]]);export{ye as S,O as u};
