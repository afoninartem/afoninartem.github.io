import{Q as U}from"./QLinearProgress.7f08d88f.js";import{r as i,k as v,q,H as P,M as x,K as t,ap as B,J as n,T as M,aq as T,Q as V,ad as C,P as f,L as F}from"./index.9c73f242.js";import{Q as N}from"./QTooltip.915f9e39.js";import{Q as O}from"./QChip.f0e0b7df.js";import{Q as w}from"./QFile.a7ad9f74.js";const D={class:"q-pa-md column items-start q-gutter-y-md"},L={class:"ellipsis relative-position"},J={__name:"MultiFilesUpload",props:["accept"],emits:["send-message"],setup(_,{emit:g}){const h=_,Q=g,u=i(null),l=i([]),s=i(null);function p(){clearTimeout(s.value)}const c=v(()=>s.value!==null),d=v(()=>u.value!==null);function m(){let a=!0;l.value=l.value.map(e=>{if(e.percent===1||e.error===!0)return e;const o=Math.min(1,e.percent+Math.random()/10),r=o<1&&Math.random()>.95;return r===!1&&o<1&&a===!0&&(a=!1),{...e,error:r,color:r===!0?"red-2":"green-2",percent:o}}),s.value=a!==!0?setTimeout(m,300):null}q(p),m();function y(){p();const a=l.value.every(e=>e.percent===1);l.value=l.value.map(e=>({...e,error:!1,color:"green-2",percent:a===!0?0:e.percent})),Q("send-message",...u.value)}function b(a){this.uploadProgress[a]={...this.uploadProgress[a],error:!0,color:"orange-2"}}function k(a){u.value=a,l.value=(a||[]).map(e=>({error:!1,color:"green-2",percent:0,icon:e.type.indexOf("video/")===0?"movie":e.type.indexOf("image/")===0?"photo":e.type.indexOf("audio/")===0?"audiotrack":"insert_drive_file"}))}return(a,e)=>(P(),x("div",D,[t(w,{"model-value":u.value,"onUpdate:modelValue":k,label:"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0444\u0430\u0439\u043B\u044B",outlined:"",multiple:"",accept:h.accept,clearable:!c.value,style:{"max-width":"400px"}},B({file:n(({index:o,file:r})=>[t(O,{class:"full-width q-my-xs",removable:c.value&&l.value[o].percent<1,square:"",onRemove:R=>b(o)},{default:n(()=>[t(U,{class:"absolute-full full-height",value:l.value[o].percent,color:l.value[o].color,"track-color":"grey-2"},null,8,["value","color"]),t(T,null,{default:n(()=>[t(V,{name:l.value[o].icon},null,8,["name"])]),_:2},1024),C("div",L,f(r.name),1),t(N,null,{default:n(()=>[F(f(r.name),1)]),_:2},1024)]),_:2},1032,["removable","onRemove"])]),_:2},[d.value?{name:"after",fn:n(()=>[t(M,{color:"primary",dense:"",icon:"cloud_upload",round:"",onClick:y,disable:!d.value,loading:c.value},null,8,["disable","loading"])]),key:"0"}:void 0]),1032,["model-value","accept","clearable"])]))}};export{J as _};
