import{A as X,C as I,r as c,j as y,ao as w,H as _,M as x,ad as u,K as d,J as B,Q as U,G as r,B as F,I as C,ae as $,T as S,O as T,P as A}from"./index.e029a779.js";import{Q as L}from"./QFile.b3050a75.js";import{Q as R}from"./QInput.3a6fe896.js";const v=X("cashlessPromotional",()=>{const{user:p}=I(),a=c(null),o=c(null),s=c(null),m=c(null),e=c(null),n=c(null),f=c(null),i=y(()=>({analysis:a.value,settlements:o.value,turningSheet1012:s.value,turningSheet4106:m.value,consumption:e.value})),g=y(()=>n.value),q=async()=>{await w.get("/accounting/cashless-promotions/result/download",{headers:{Authorization:`Bearer ${p.token}`},responseType:"blob"}).then(t=>{const l=t.headers.get("Content-Type");console.log(l);const h=`${new Date().toLocaleDateString()} \u0411\u0435\u0437\u043D\u0430\u043B\u0438\u0447\u043D\u044B\u0439 \u0440\u0430\u0441\u0441\u0447\u0435\u0442, \u0440\u0435\u043A\u043B\u0430\u043C\u043D\u044B\u0435 \u043C\u0430\u0442\u0435\u0440\u0438\u0430\u043B\u044B.xlsx`;console.log(h);const V=URL.createObjectURL(t.data),b=document.createElement("a");b.href=V,b.download=h,document.body.appendChild(b),b.click(),document.body.removeChild(b),window.URL.revokeObjectURL(V)})},D=(t,l)=>{switch(l){case"analysis":a.value=t;break;case"settlements":o.value=t;break;case"10.12":s.value=t;break;case"41.06":m.value=t;break;case"consumption":e.value=t;break}},P=async(t=0)=>{if(!e.value)return;const l=new FormData;l.append("consumption",e.value),await w.post("/accounting/cashless-promotions/consumption/upload",l,{headers:{Authorization:`Bearer ${p.token}`,"Content-Type":"multipart/form-data",Sum:t}}).then(h=>{f.value=h.data.data}).catch(h=>console.log(h))},Q=y(()=>f.value);return{uploadFile:D,upload:async()=>{const t=new FormData;t.append("analysis",i.value.analysis),t.append("settlements",i.value.settlements),t.append("10.12",i.value.turningSheet1012),t.append("41.06",i.value.turningSheet4106),await w.post("/accounting/cashless-promotional/handbook/upload",t,{headers:{Authorization:`Bearer ${p.token}`,"Content-Type":"multipart/form-data"}}).then(l=>{n.value=l.data.data,console.log(l)}).catch(l=>console.log(l))},saveXLSX:q,uploadConsumption:P,consumption:e,cashlessPromotional:Q,files:i,handbookSummary:g}}),N={class:"q-pa-md"},j={class:"q-gutter-md row items-start"},k={__name:"FileUploadTXT",props:["mode","label"],setup(p){const a=p,o=c(null),{uploadFile:s}=v();return(m,e)=>(_(),x("div",N,[u("div",j,[d(L,{modelValue:o.value,"onUpdate:modelValue":[e[0]||(e[0]=n=>o.value=n),e[1]||(e[1]=n=>r(s)(o.value,a.mode))],label:a.label,square:"",filled:"","use-chips":"",accept:".txt",style:{width:"400px"}},{prepend:B(()=>[d(U,{name:"attach_file"})]),_:1},8,["modelValue","label"])])]))}};const z={class:"cashless-promotions__handbook"},E=u("h4",null,"\u0421\u043F\u0440\u0430\u0432\u043E\u0447\u043D\u0438\u043A \u0440\u0435\u043A\u043B\u0430\u043C\u043D\u044B\u0445 \u043C\u0430\u0442\u0435\u0440\u0438\u0430\u043B\u043E\u0432, \u043F\u0440\u0438\u043E\u0431\u0440\u0435\u0442\u0435\u043D\u043D\u044B\u0445 \u0437\u0430 \u0431\u0435\u0437\u043D\u0430\u043B\u0438\u0447\u043D\u044B\u0439 \u0440\u0430\u0441\u0447\u0435\u0442",-1),H={class:"upload-section"},M={class:"upload-section__turning-sheets"},O={class:"upload-section__reports"},G={class:"summary-section"},le={__name:"HandbookCashless",setup(p){const{upload:a}=v(),{handbookSummary:o,files:s}=F(v()),m=y(()=>s.value&&s.value.analysis&&s.value.settlements&&s.value.turningSheet1012&&s.value.turningSheet4106);return(e,n)=>(_(),x("div",z,[E,u("section",H,[u("div",M,[d(k,{mode:"10.12",label:"\u041E\u0431\u043E\u0440\u043E\u0442\u043D\u043E-\u0441\u0430\u043B\u044C\u0434\u043E\u0432\u0430\u044F \u0432\u0435\u0434\u043E\u043C\u043E\u0441\u0442\u044C \u043F\u043E \u0441\u0447\u0435\u0442\u0443 10.12.txt"}),d(k,{mode:"41.06",label:"\u041E\u0431\u043E\u0440\u043E\u0442\u043D\u043E-\u0441\u0430\u043B\u044C\u0434\u043E\u0432\u0430\u044F \u0432\u0435\u0434\u043E\u043C\u043E\u0441\u0442\u044C \u043F\u043E \u0441\u0447\u0435\u0442\u0443 41.06.txt"})]),u("div",O,[d(k,{mode:"analysis",label:"TXT \u0410\u043D\u0430\u043B\u0438\u0437 \u0440\u0435\u043A\u043B\u0430\u043C\u043D\u043E\u0439 \u043F\u0440\u043E\u0434\u0443\u043A\u0446\u0438\u0438"}),d(k,{mode:"settlements",label:"TXT \u0420\u0430\u0441\u0447\u0435\u0442\u044B \u0441 \u043F\u043E\u0441\u0442\u0430\u0432\u0449\u0438\u043A\u0430\u043C\u0438"})]),r(m)?(_(),C(S,{key:0,class:"btn-fixed-width",color:"secondary",label:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C",icon:"upload",style:{height:"61px"},onClick:n[0]||(n[0]=$(f=>r(a)(),["prevent"]))})):T("",!0)]),u("section",G,[u("p",null,A(r(o)),1)])]))}},J={class:"q-pa-md"},K={class:"q-gutter-md row items-start"},W={__name:"FileUpload",props:["mode","label"],setup(p){const a=p,o=c(null),{uploadFile:s}=v();return(m,e)=>(_(),x("div",J,[u("div",K,[d(L,{modelValue:o.value,"onUpdate:modelValue":[e[0]||(e[0]=n=>o.value=n),e[1]||(e[1]=n=>r(s)(o.value,a.mode))],label:a.label,square:"",filled:"","use-chips":"",accept:".xlsx",style:{width:"400px"}},{prepend:B(()=>[d(U,{name:"attach_file"})]),_:1},8,["modelValue","label"])])]))}};const Y={class:"cashless-promotions__consumption"},Z=u("h4",null,"\u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430 \u0440\u0430\u0441\u0445\u043E\u0434\u0430 (\u0441\u043A\u043B\u0430\u0434\u0441\u043A\u043E\u0439 \u0443\u0447\u0435\u0442 \u041C\u041F\u0417)",-1),ee={class:"upload-section"},te={class:"inputs"},ue={__name:"PromotionalConsumption",setup(p){const{cashlessPromotional:a,files:o}=F(v()),{uploadConsumption:s,saveXLSX:m}=v(),e=c(null),n=y(()=>o.value&&o.value.consumption);return(f,i)=>(_(),x("div",Y,[Z,u("section",ee,[u("div",te,[d(W,{mode:"consumption",label:"\u0421\u043A\u043B\u0430\u0434\u0441\u043A\u043E\u0439 \u0443\u0447\u0435\u0442 \u041C\u041F\u0417"}),d(R,{modelValue:e.value,"onUpdate:modelValue":i[0]||(i[0]=g=>e.value=g),modelModifiers:{number:!0},type:"number",label:"\u041E\u043F\u0446\u0438\u043E\u043D\u0430\u043B\u044C\u043D\u043E: 1% \u0432\u044B\u0440\u0443\u0447\u043A\u0438",square:"",filled:"",style:{width:"400px"}},null,8,["modelValue"])]),r(n)?(_(),C(S,{key:0,class:"btn-fixed-width",color:"secondary",label:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C",icon:"upload",style:{height:"61px"},onClick:i[1]||(i[1]=$(g=>r(s)(e.value),["prevent"]))})):T("",!0)]),r(a)&&r(a).length?(_(),C(S,{key:0,class:"btn-fixed-width",color:"secondary",label:"\u0421\u043A\u0430\u0447\u0430\u0442\u044C",icon:"download",onClick:$(r(m),["prevent"])},null,8,["onClick"])):T("",!0)]))}};export{le as _,ue as a};
