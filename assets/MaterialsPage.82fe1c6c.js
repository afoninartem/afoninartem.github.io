import{b as N,Q as F}from"./QTable.97a6ca1e.js";import{X as I,D as z,r as d,a as _,ao as B,s as R,m as O,p as b,y as A,v as a,t as n,Q as U,E as k,q as T,A as S,u as M,x as W,ad as w,B as D,aC as H}from"./index.8f4f6de6.js";import{Q}from"./QInput.0af2b25a.js";import{Q as G}from"./QTd.e032793f.js";import{Q as X,a as Z}from"./QBar.94f53545.js";import{Q as j}from"./QTooltip.cc2936e5.js";import{Q as J,a as q}from"./QCard.bc2dcaeb.js";import{Q as $}from"./QToggle.a5de9584.js";import{Q as K}from"./QForm.6247ff88.js";import{Q as Y}from"./QDialog.231b9ba1.js";import{u as ee}from"./use-quasar.62dea5a6.js";import"./QSeparator.204eea84.js";import"./use-dark.ef34ec87.js";import"./QList.1d24b4ba.js";import"./scroll.99a2be16.js";import"./use-form.b6f3b663.js";import"./QChip.4c4e794d.js";import"./QItem.4b7ac684.js";import"./position-engine.0000a277.js";import"./selection.369d4e44.js";import"./use-key-composition.36c30cfe.js";import"./format.3e32b8d9.js";import"./use-file-dom-props.86cec7f2.js";import"./use-prevent-scroll.ab7b9b10.js";const x=I("materials",()=>{const{user:g}=z(),c=d([]),m=d(!1),u=d(null),p=d(null),v=(l,P)=>{u.value=P,m.value=!0,p.value={...u.value}},h=()=>{u.value={...p.value}},C=async()=>{await B.post("/warehouse/materials/update",{...u.value},{headers:{Authorization:`Bearer ${g.token}`}}).then(l=>{e()}).catch(l=>console.log(l))},f=async()=>{await B.post("/warehouse/materials/delete",{...u.value},{headers:{Authorization:`Bearer ${g.token}`}}).then(l=>{e(),console.log(l.data.data)}).catch(l=>console.log(l))},V=()=>{m.value=!1,u.value=null},e=async()=>{await B.get("/warehouse/materials",{headers:{Authorization:`Bearer ${g.token}`}}).then(l=>c.value=l.data.data).catch(l=>console.log(l))},y=_(()=>c.value),r=_(()=>m.value),s=_(()=>u.value),i=_(()=>p.value);return{materials:y,dialogState:r,initiateCard:i,materialCard:s,deleteMaterial:f,getAllMaterials:e,openMaterialCard:v,resetMaterialCard:h,saveMaterialCard:C,closeMaterialCard:V}}),ae={class:"container"},le={__name:"MaterialsTable",setup(g){const{materials:c,dialogState:m}=R(x()),{getAllMaterials:u,openMaterialCard:p}=x(),v=d([]),h=_(()=>v.value.length==0?c.value:c.value.filter(r=>v.value.some(s=>r.code.includes(s)))),C=[{label:"\u0420\u0435\u043C\u043E\u043D\u0442/\u041F\u0430\u043D\u0435\u043B\u0438",value:"PANEL"},{label:"\u0420\u0435\u043C\u043E\u043D\u0442/\u0424\u043E\u0442\u043E\u043E\u0431\u043E\u0438",value:"WPPHO"},{label:"\u0420\u0435\u043C\u043E\u043D\u0442/\u041E\u0431\u043E\u0438",value:"WPCOM"},{label:"\u0420\u0435\u043C\u043E\u043D\u0442/\u0414\u0438\u0437. \u043E\u0431\u043E\u0438",value:"WPDES"},{label:"\u0420\u0435\u043C\u043E\u043D\u0442/\u041E\u0441\u0432\u0435\u0449\u0435\u043D\u0438\u0435",value:"LIGHT"},{label:"\u0424\u0421: \u043F\u0438\u0449\u0435\u0432\u0430\u044F",value:"TREAT"},{label:"\u0421\u0442\u043E\u043B\u043E\u0432\u0430\u044F",value:"DINER"},{label:"\u0414\u0435\u043A\u043E\u0440",value:"DECOR"}],f=d(""),V=[["code","\u041A\u043E\u0434\u0412\u044B\u0433\u0440\u0443\u0437\u043A\u0438"],["name","\u041D\u0430\u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u0435"],["min_leftover","\u041C\u0438\u043D. \u043E\u0441\u0442\u0430\u0442\u043E\u043A"],["pack","\u0423\u043F\u0430\u043A\u043E\u0432\u043A\u0430"],["is_stopped","\u041E\u0442\u0433\u0440\u0443\u0436\u0430\u0435\u043C?"],["has_limits","\u041E\u0433\u0440\u0430\u043D\u0438\u0447\u0435\u043D\u0438\u044F"]],e=_(()=>V.map(r=>({name:r[0],required:!0,label:r[1],field:r[0],format:s=>r[0]=="has_limits"?s?"\u0414\u0430":"\u041D\u0435\u0442":`${s}`,align:"left",sortable:!0}))),y={page:1,rowsPerPage:0};return O(async()=>{await u()}),(r,s)=>(b(),A("div",ae,[a(F,{title:"\u0420\u041F \u0438 \u0410\u0425\u041E",rows:h.value,columns:e.value,class:"my-sticky-header-table","row-key":r.name,onRowClick:M(p),pagination:y,filter:f.value},{"top-right":n(i=>[a(N,{modelValue:v.value,"onUpdate:modelValue":s[0]||(s[0]=l=>v.value=l),multiple:"",outlined:"",dense:"","options-dense":"","emit-value":"","map-options":"",label:"\u041F\u0430\u043F\u043A\u0438",options:C,style:{"min-width":"150px"},class:"q-mr-md"},null,8,["modelValue"]),a(Q,{dense:"",debounce:"300",modelValue:f.value,"onUpdate:modelValue":s[1]||(s[1]=l=>f.value=l),name:"search",placeholder:"\u041F\u043E\u0438\u0441\u043A"},{append:n(()=>[a(U,{name:"search"})]),_:1},8,["modelValue"]),a(k,{flat:"",round:"",dense:"",icon:i.inFullscreen?"fullscreen_exit":"fullscreen",onClick:i.toggleFullscreen,class:"q-ml-md"},null,8,["icon","onClick"])]),"body-cell-is_stopped":n(i=>[a(G,{props:i},{default:n(()=>[i.value=="true"?(b(),T(U,{key:0,name:"do_not_disturb",color:"negative",size:"24px"})):S("",!0),i.value=="false"?(b(),T(U,{key:1,name:"check_circle",color:"positive",size:"24px"})):S("",!0)]),_:2},1032,["props"])]),_:1},8,["rows","columns","row-key","onRowClick","filter"])]))}},te={class:"container"},oe={class:"text-h5"},se={class:"text-h6"},re={class:"btn-block"},ne={__name:"MaterialCard",setup(g){ee();const{user:c}=R(z()),{dialogState:m,materialCard:u}=R(x()),{closeMaterialCard:p,resetMaterialCard:v,saveMaterialCard:h,deleteMaterial:C}=x(),f=d(!0),V=d(null),e=d(u),y=d(null),r=()=>{V.value=setTimeout(()=>{i()},1e3)},s=()=>{clearTimeout(V.value)},i=()=>{C(),p()},l=_(()=>e.value.stop_date=="0001-01-01T00:00:00Z"||e.value.stop_date==null?"\u043D\u0430\u0447\u0430\u043B\u0430 \u0432\u0440\u0435\u043C\u0435\u043D":new Date(e.value.stop_date).toLocaleDateString("ru-RU")),P=()=>{e.value.stop_date=new Date},E=async()=>{h()},L=()=>{v()};return(de,t)=>(b(),A("div",te,[a(Y,{modelValue:M(m),"onUpdate:modelValue":t[7]||(t[7]=o=>H(m)?m.value=o:null),persistent:"",maximized:f.value,"transition-show":"slide-left","transition-hide":"slide-left"},{default:n(()=>[a(J,null,{default:n(()=>[a(X,null,{default:n(()=>[a(Z),a(k,{dense:"",flat:"",icon:"close",onClick:M(p)},{default:n(()=>[a(j,{class:"bg-white text-primary"},{default:n(()=>[W("\u0417\u0430\u043A\u0440\u044B\u0442\u044C")]),_:1})]),_:1},8,["onClick"])]),_:1}),a(q,null,{default:n(()=>[w("div",oe,D(e.value.name),1),w("div",se,D(e.value.code),1)]),_:1}),a(q,{class:"q-pt-none"},{default:n(()=>[a(K,{ref_key:"materialCardForm",ref:y,onSubmit:E,onReset:L,class:"q-gutter-md"},{default:n(()=>[a(Q,{label:"\u0410\u0434\u0440\u0435\u0441\u0430",filled:"",outlined:"",modelValue:e.value.address,"onUpdate:modelValue":t[0]||(t[0]=o=>e.value.address=o)},null,8,["modelValue"]),a(Q,{type:"number",label:"\u041C\u0438\u043D\u0438\u043C\u0430\u043B\u044C\u043D\u044B\u0439 \u043E\u0441\u0442\u0430\u0442\u043E\u043A",modelValue:e.value.min_leftover,"onUpdate:modelValue":t[1]||(t[1]=o=>e.value.min_leftover=o)},null,8,["modelValue"]),a(Q,{type:"number",label:"\u0423\u043F\u0430\u043A\u043E\u0432\u043A\u0430",modelValue:e.value.pack,"onUpdate:modelValue":t[2]||(t[2]=o=>e.value.pack=o)},null,8,["modelValue"]),a($,{label:e.value.is_stopped?`\u0412 \u0441\u0442\u043E\u043F-\u043B\u0438\u0441\u0442\u0435 \u0441 ${l.value}`:`\u041E\u0442\u0433\u0440\u0443\u0436\u0430\u0435\u043C \u0441 ${l.value}`,color:"red","false-value":!1,"true-value":!0,modelValue:e.value.is_stopped,"onUpdate:modelValue":[t[3]||(t[3]=o=>e.value.is_stopped=o),P]},null,8,["label","modelValue"]),a($,{label:e.value.has_limits?"\u0415\u0441\u0442\u044C \u043E\u0433\u0440\u0430\u043D\u0438\u0447\u0435\u043D\u0438\u044F":"\u041D\u0435\u0442 \u043E\u0433\u0440\u0430\u043D\u0438\u0447\u0435\u043D\u0438\u0439",color:"red","false-value":!1,"true-value":!0,modelValue:e.value.has_limits,"onUpdate:modelValue":t[4]||(t[4]=o=>e.value.has_limits=o)},null,8,["label","modelValue"]),a($,{label:e.value.cabinet?"\u0425\u0440\u0430\u043D\u0438\u0442\u0441\u044F \u0432 \u043A\u0430\u0431\u0438\u043D\u0435\u0442\u0435":"\u0425\u0440\u0430\u043D\u0438\u0442\u0441\u044F \u043D\u0430 \u0441\u043A\u043B\u0430\u0434\u0435",color:"yellow","false-value":!1,"true-value":!0,modelValue:e.value.cabinet,"onUpdate:modelValue":t[5]||(t[5]=o=>e.value.cabinet=o)},null,8,["label","modelValue"]),e.value.has_limits?(b(),T(Q,{key:0,type:"number",label:"\u041E\u0433\u0440\u0430\u043D\u0438\u0447\u0435\u043D\u0438\u0435 \u043D\u0430 \u043E\u0442\u0433\u0440\u0443\u0437\u043A\u0443 (\u0432 \u0435\u0434\u0438\u043D\u0438\u0446\u0430\u0445 \u0438\u0437\u043C\u0435\u0440\u0435\u043D\u0438\u044F \u043C\u0430\u0442\u0435\u0440\u0438\u0430\u043B\u0430)",modelValue:e.value.limit,"onUpdate:modelValue":t[6]||(t[6]=o=>e.value.limit=o)},null,8,["modelValue"])):S("",!0),w("div",re,[a(k,{label:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C",type:"submit",color:"positive"}),a(k,{label:"\u0421\u0431\u0440\u043E\u0441",type:"reset",color:"primary",flat:"",class:"q-ml-sm"}),M(c).role==1?(b(),T(k,{key:0,label:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C",color:"red",flat:"",class:"q-ml-sm",onMousedown:r,onMouseup:s,onMouseleave:s})):S("",!0)])]),_:1},512)]),_:1})]),_:1})]),_:1},8,["modelValue","maximized"])]))}},ue={class:"container"},ie=w("h3",null,"\u0421\u043F\u0440\u0430\u0432\u043E\u0447\u043D\u0438\u043A \u043C\u0430\u0442\u0435\u0440\u0438\u0430\u043B\u043E\u0432",-1),Ae={__name:"MaterialsPage",setup(g){return(c,m)=>(b(),A("div",ue,[ie,a(le),a(ne)]))}};export{Ae as default};
