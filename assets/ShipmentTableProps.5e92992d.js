import{X as I,D as N,r as $,a as D,ao as R,p as s,y as n,ad as e,B as l,F as y,z as g,aL as L,x as k,A as _,_ as z,o as C,ae as M,u as p,q as V,aM as q,aN as F}from"./index.f5fd8453.js";import{u as j}from"./leftDrawer-store.14fe8efa.js";const O=I("shipment",()=>{const{user:t}=N(),{closeLeftDrawer:c}=j(),d=$(null),m=D(()=>d.value),u=()=>{var i;return(i=d.value)!=null&&i.spbnn.exists?"spbnn":"msc"},a=[{label:"\u2116",field:"num"},{label:"\u041C\u0430\u0448\u0438\u043D\u0430",field:"transport"},{label:"\u0421\u0430\u043B\u043E\u043D",field:"shop"},{label:"\u041C\u0430\u0442\u0435\u0440\u0438\u0430\u043B\u044B",field:"materials"},{label:"\u041F/\u041F",field:"shipment_places"},{label:"\u0417\u0430\u044F\u0432\u043A\u0438",field:"orders"}],S=D(()=>a.map(i=>({name:i.field,required:!0,label:i.label,field:i.field,align:"left",sortable:!1}))),x=D(()=>d.value.table);return{shipment:m,columns:S,rows:x,show:async()=>{await R.get("/warehouse/shipment/show",{headers:{Authorization:`Bearer ${t.token}`}}).then(i=>d.value=i.data.data).catch(i=>console.log(i))},print:async()=>{c(),setTimeout(()=>window.print(),1)},defaultRegion:u}});const X={class:"shipment-total"},G={key:0},H="\u0428\u043E\u043A\u043E\u043B\u0430\u0434 \u0441 \u043B\u043E\u0433\u043E\u0442\u0438\u043F\u043E\u043C 5 \u0433\u0440.",J={__name:"ShipmentTotal",props:["shipment","tubuses"],setup(t){const c=t,d=m=>m.includes("TREAT")||m.includes("PAPER")?"font-weight: 700":null;return(m,u)=>(s(),n("div",X,[e("h6",null,"\u0412\u0441\u0435\u0433\u043E \u0432 \u0441\u0431\u043E\u0440\u043A\u0435 "+l(new Date().toLocaleDateString())+":",1),e("ol",null,[(s(!0),n(y,null,g(t.shipment.vtl,(a,S)=>(s(),n("li",{key:`tl-${S}`},[e("p",{style:L(d(a.code))},[k(l(a.name)+" - "+l(a.amount),1),a.name==H?(s(),n("span",G," (\u0432 \u0442\u0443\u0431\u0430\u0445 - "+l(c.tubuses)+")",1)):_("",!0)],4)]))),128))])]))}};const w=t=>(q("data-v-3243c930"),t=t(),F(),t),K={key:0,class:"shipment"},Q={class:"warning"},U={key:0},W={key:1},Y={class:"region-btns"},Z=["onClick"],ee={class:"print-area"},te={class:"shipment__info"},se=w(()=>e("thead",null,[e("tr",null,[e("th",{class:"header rownum"},"\u2116"),e("th",{class:"header transport"},"\u041C\u0430\u0448\u0438\u043D\u0430"),e("th",{class:"header shop"},"\u0421\u0430\u043B\u043E\u043D"),e("th",{class:"header materials"},"\u041C\u0430\u0442\u0435\u0440\u0438\u0430\u043B\u044B"),e("th",{class:"header places"},"\u041F/\u041F"),e("th",{class:"header orders"},"\u0417\u0430\u044F\u0432\u043A\u0438")])],-1)),ne=w(()=>e("td",{class:"rownum"},null,-1)),le={class:"transport"},ae={class:"shop"},oe=w(()=>e("br",null,null,-1)),re={key:0},ie=w(()=>e("hr",null,null,-1)),ce={class:"materials"},ue={key:0,style:{border:"3px double"}},he=w(()=>e("td",null,null,-1)),de={class:"orders"},me={__name:"ShipmentTableProps",props:["shipment"],setup(t){const c=t,{defaultRegion:d}=O();let m=$(null);const u=$(null);let a=$(d());const S={msc:"\u041C\u043E\u0441\u043A\u0432\u0430 \u0438 \u041F\u0440\u043E\u0447\u0438\u0435 \u0440\u0435\u0433\u0438\u043E\u043D\u044B",spb:"\u0421\u0430\u043D\u043A\u0442-\u041F\u0435\u0442\u0435\u0440\u0431\u0443\u0440\u0433",nn:"\u041D\u0438\u0436\u043D\u0438\u0439 \u041D\u043E\u0432\u0433\u043E\u0440\u043E\u0434 \u0438 \u043F\u0440\u0438\u043B\u0435\u0436\u0430\u0449\u0438\u0435 \u0440\u0435\u0433\u0438\u043E\u043D\u044B",spbnn:"\u0421\u041F\u0411 + \u041D\u041D"},x=r=>{let b=0;return r.orders.forEach(o=>{o.comment.includes("\u0441\u043E\u0431\u0440\u0430\u043D")&&r.materials.forEach(h=>{h.name.includes("\u0441\u043E\u0431\u0440\u0430\u043D\u043E \u043C\u0435\u0441\u0442")&&(b+=+h.amount)})}),b},A=()=>{let r={};Object.keys(c.shipment).forEach(o=>{c.shipment[o]&&c.shipment[o].exists&&(r[o]=c.shipment[o])}),m.value=r},B=()=>{let r;const b=c.shipment.vtl.filter(o=>o.name=="\u0428\u043E\u043A\u043E\u043B\u0430\u0434 \u0441 \u043B\u043E\u0433\u043E\u0442\u0438\u043F\u043E\u043C 5 \u0433\u0440.");b.length>0&&(r=b[0].amount/250),u.value=r},i=r=>{a.value=r},P=r=>{if(r.includes("\u0441\u043E\u0431\u0440\u0430\u043D"))return"border: 1px double black"};return C(()=>{A(),B()}),(r,b)=>t.shipment?(s(),n("div",K,[e("div",Q,[u.value>0?(s(),n("p",U,"\u0412\u0441\u0435 \u0442\u0443\u0431\u044B c \u0448\u043E\u043A\u043E\u043B\u0430\u0434\u043E\u043C \u043E\u0431\u044F\u0437\u0430\u0442\u0435\u043B\u044C\u043D\u043E \u0441\u0431\u043E\u043A\u0443 \u043F\u0440\u043E\u043C\u0430\u0440\u043A\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u0434\u0430\u0442\u043E\u0439! \u0414\u0430, \u0410\u043B\u0435\u043A\u0441\u0435\u0439, \u0434\u0430\u0436\u0435 \u0435\u0441\u043B\u0438 \u0430\u043A\u0446\u0438\u044F \u0438 \u0440\u0430\u0431\u043E\u0442\u044B \u043C\u043D\u043E\u0433\u043E.")):_("",!0),u.value>0?(s(),n("p",W,[k("\u0421\u0435\u0433\u043E\u0434\u043D\u044F \u043F\u043E\u0442\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044F \u044D\u0442\u0438\u043A\u0435\u0442\u043E\u043A \u0441 \u0434\u0430\u0442\u043E\u0439: "),e("b",null,l(u.value),1),k(".")])):_("",!0)]),e("div",Y,[(s(!0),n(y,null,g(p(m),(o,h)=>(s(),n("div",{class:"region-btns__btn",key:`reg-btn-${o}`},[t.shipment[h].exists?(s(),n("button",{key:0,onClick:M(f=>i(h),["prevent"])},l(S[h]),9,Z)):_("",!0)]))),128))]),e("div",ee,[e("div",te,[e("p",null,"\u041E\u0442\u0433\u0440\u0443\u0437\u043A\u0430 \u043D\u0430 "+l(t.shipment[p(a)].shipment_info.shipment_date),1),e("p",null,"\u0421\u0431\u043E\u0440\u043A\u0430 "+l(t.shipment[p(a)].shipment_info.gathering_date),1),e("p",null,"\u041D\u0430\u0447\u0430\u043B\u043E \u0440\u0430\u0431\u043E\u0442\u044B "+l(t.shipment[p(a)].shipment_info.start_time),1),e("p",null,"\u0420\u0435\u0433\u0438\u043E\u043D: "+l(t.shipment[p(a)].shipment_info.region),1),e("p",null,"\u0417\u0430\u044F\u0432\u043E\u043A: "+l(t.shipment[p(a)].shipment_info.orders_number),1),e("p",null,"\u0421\u0430\u043B\u043E\u043D\u043E\u0432: "+l(t.shipment[p(a)].shipment_info.shops_number),1)]),e("table",null,[se,(s(!0),n(y,null,g(t.shipment[p(a)].shipment_data.transport,(o,h)=>(s(),n("tbody",{class:"table-body",key:`t-${h}`},[(s(!0),n(y,null,g(o.shops,(f,E)=>(s(),n("tr",{key:`s-${E}`},[ne,e("td",le,l(o.name),1),e("td",ae,[k(l(f.name),1),oe,x(f)>0?(s(),n("span",re,[ie,k("\u0421\u043E\u0431\u0440\u0430\u043D\u043E \u043C\u0435\u0441\u0442: "+l(x(f)),1)])):_("",!0)]),e("td",null,[e("div",ce,[(s(!0),n(y,null,g(f.materials,(v,T)=>(s(),n("div",{class:"material",key:`m-${T}`},[e("p",null,[v.cabinet?(s(),n("span",ue,"213")):_("",!0),k(" "+l(v.name)+" - ",1),e("strong",null,l(v.amount),1)])]))),128))])]),he,e("td",null,[e("div",de,[(s(!0),n(y,null,g(f.orders,(v,T)=>(s(),n("p",{key:`${h}${E}${T}`,style:L(P(v.comment))},l(v.number),5))),128))])])]))),128))]))),128))]),t.shipment&&t.shipment.vtl?(s(),V(J,{key:0,shipment:t.shipment,tubuses:u.value},null,8,["shipment","tubuses"])):_("",!0)])])):_("",!0)}};var be=z(me,[["__scopeId","data-v-3243c930"]]);export{be as S,O as u};
